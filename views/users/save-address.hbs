<section class="save-address" style="background-color: rgba(255, 191, 191, 1);">
  <div class="container">

     <div class="row mr-3 ">
    {{#each allAddress}}
    {{#each this.address}}
   
    <div class="col-md-3 p-5 d-flex justify-content-center">
    <div class="card" style="width: 18rem;">
      <div class="card-body text-center">
        <h5 class="card-title ">Address</h5><hr>
        <p class="text-muted mb-0">{{this.name}}</p>
        <p class="text-muted mb-0">Ph:{{this.phone}}</p>
        <p class="text-muted mb-0">{{this.housename}},{{this.place}},<br>{{this.pincode}}</p>
        <a href="/delivery-address/{{this._id}}" class="btn " style="background-color: rgb(78, 5, 5);color: white; margin-top: 20px; " type="submit">Deliver to this Address</a>
      </div>
    </div>
    </div>

    {{/each}}
  {{/each}}
   </div>

    <form  id="address-form">
      <div class="row">
        <div class="col-md-8 mb-4 mt-5 ">
          <div class="card mb-4">
            <div class="card-header py-3  " style="background-color: rgb(54, 8, 8); color: white;">
              <h5 class="mb-0">Add New Address</h5>
            </div>
            <div class="card-body">
                <!-- 2 column grid layout with text inputs for the first and last names -->
                <div class="row mb-4">
                  <div class="form-outline">
                    <label class="form-label" for="form7Example1">Name</label>
                    <input type="text" name="name" id="form7Example1" class="form-control" required />

                  </div>
                </div>


                <!-- Number input -->
                <div class="form-outline mb-4">
                  <label class="form-label" for="form7Example6">Phone</label>
                  <input type="number" name="phone" id="form7Example6" class="form-control"required />

                </div>


                <!-- Text input -->
                <div class="form-outline mb-4">
                  <label class="form-label" for="form7Example4">House Name</label>
                  <input type="text" name="housename" id="housename" class="form-control" required />

                </div>

                <div class="form-outline mb-4">
                  <label class="form-label" for="form7Example4">Place</label>
                  <input type="text" name="place" id="place" class="form-control" required />

                </div>

                <div class="form-outline mb-4">
                  <label class="form-label" for="form7Example4">Pincode</label>
                  <input type="text" name="pincode" id="pincode" class="form-control"  required/>

                </div>
                <input type="text" name="userid" id="" value="{{user._id}}" hidden>
                {{!--
              </form> --}}

               <div class="d-flex justify-content-center">
                  <button style="background-color: rgb(78, 5, 5);color: white; margin-top: 20px;" type="submit"
                    class="btn">
                   Save Address
                  </button>
                </div>

            </div>
          </div>
        </div>
  </form>
        <div class="col-md-4 mb-4 mt-5">
          <div class="card mb-4">
            <div class="card-header py-3">
              <h5 class="mb-0">Your Total &nbsp; &nbsp; &#x20b9 {{total.total}}.00</h5>
            </div>
            <div class="card-body">


            <ul class="list-group list-group-flush">
              <li
                class="list-group-item d-flex justify-content-between align-items-center border-0 px-0 pb-0">
                Products Price 
                <span>Rs.{{total.total_a}}</span>
              </li>
              <li class="list-group-item d-flex justify-content-between align-items-center px-0">
                Shipping Charge
                {{!-- {{#each products}}
                {{#each this.cartItems }} --}}
                <span>Rs.{{total.ship}}</span>
                {{!-- {{/each}}
                {{/each}} --}}
              </li>
              <li
                class="list-group-item d-flex justify-content-between align-items-center border-0 px-0 mb-3">
                <div>
                <h5> <strong>Total amount</strong></h5> 
                  <strong>
                    <p class="mb-0"></p>
                  </strong>
                </div>
                <span id="totalValue"><h5><strong>Rs.{{total.total}}</strong></h5></span>
              </li>
            </ul>


                {{!-- <div class="d-flex justify-content-center">
                  <button style="background-color: rgb(78, 5, 5);color: white; margin-top: 20px;" type="submit"
                    class="btn">
                    Make purchase
                  </button>
                </div> --}}
            </div>
          </div>
        </div>
      </div>
  
  </div>
</section>
<script>
  $("#address-form").submit((e) => {
    e.preventDefault()
    $.ajax({
      url: '/save-address',
      method: 'post',
      data: $('#address-form').serialize(),
      success: (response) => {
        alert('Address added')
        location.reload() 
      }
    })
  })
</script>